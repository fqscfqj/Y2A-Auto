# Y2A-Auto 浏览器扩展

Y2A-Auto 官方浏览器扩展，提供自动 Cookie 同步和视频推送功能。

## 🚀 快速安装

### 1. 加载扩展到浏览器

#### Chrome/Edge
1. 打开浏览器，访问 `chrome://extensions/` 或 `edge://extensions/`
2. 开启右上角的"开发者模式"开关
3. 点击"加载已解压的扩展程序"
4. 选择此目录 (`browser-extension/`)
5. 确认扩展加载成功

#### Firefox
1. 打开浏览器，访问 `about:debugging`
2. 点击"此Firefox"
3. 点击"临时载入附加组件"
4. 选择 `manifest.json` 文件
5. 确认扩展加载成功

### 2. 配置服务器地址

1. 右键点击扩展图标，选择"选项"
2. 或者在扩展管理页面点击"详细信息" → "扩展程序选项"
3. 在设置页面输入您的Y2A-Auto服务器地址
4. 点击"测试连接"确认连接正常
5. 点击"保存设置"

## 🔧 文件说明

| 文件 | 说明 |
|------|------|
| `manifest.json` | 扩展清单文件，定义扩展权限和配置 |
| `background.js` | 后台服务脚本，处理 Cookie 同步核心逻辑 |
| `content.js` | 内容脚本，在 YouTube 页面添加操作按钮 |
| `popup.html` / `popup.js` | 扩展弹窗页面和逻辑 |
| `options.html` / `options.js` | 扩展设置页面和逻辑 |
| `styles.css` | 样式文件，定义UI组件样式 |

## ✨ 主要功能

### 🍪 自动 Cookie 同步
- **智能Cookie管理** - 自动提取和同步YouTube关键认证Cookie
- **变化检测** - 智能检测Cookie变化并及时同步到服务器
- **定时同步** - 可配置的自动同步间隔（默认5分钟）
- **容错机制** - 同步失败时的自动重试和错误处理

### 📤 视频操作
- **一键添加** - 直接在YouTube视频页面添加任务到Y2A-Auto
- **Cookie同步** - 手动触发Cookie同步功能
- **状态反馈** - 实时显示操作状态和结果
- **自动适配** - 兼容YouTube界面变化

### 📊 状态管理
- **可视化监控** - 实时显示同步状态和服务器连接状态
- **快速操作** - 通过扩展弹窗快速执行常用操作
- **错误诊断** - 清晰的错误信息和解决建议

## ⚙️ 配置选项

### 服务器地址格式

```bash
# 本地部署
http://localhost:5000
http://127.0.0.1:5000

# 公网部署（推荐HTTPS）
https://your-domain.com
https://your-domain.com:8080
```

### 同步间隔设置

- **5分钟** (300000ms) - 推荐设置，应对YouTube严格检测
- **10分钟** (600000ms) - 平衡模式
- **30分钟** (1800000ms) - 轻量模式

## 🔍 使用方法

### Cookie 同步
- **自动同步** - 扩展安装后自动按间隔执行
- **变化同步** - 检测到Cookie变化时立即同步
- **手动同步** - 通过弹窗或YouTube页面按钮手动触发

### 视频推送
在YouTube视频页面：
1. 查看页面右侧的"添加任务"和同步按钮
2. 点击"添加任务"将视频添加到Y2A-Auto处理队列
3. 点击同步按钮立即同步Cookie
4. 查看操作状态反馈

## 🛠️ 故障排除

### 扩展无法加载
- 确认已启用"开发者模式"
- 检查文件路径是否正确
- 查看浏览器控制台错误信息

### Cookie 同步失败
- 确认Y2A-Auto服务器运行正常
- 检查服务器地址配置是否正确
- 查看扩展后台页面的错误日志
- 尝试手动同步测试连接

### 操作按钮不显示
- 刷新YouTube页面
- 确认当前页面是视频页面（/watch路径）
- 检查扩展是否正常加载

### 连接问题
常见错误及解决方案：
- **404错误** - 检查服务器地址和端口
- **网络错误** - 检查网络连接和防火墙设置
- **超时** - 检查服务器响应速度

## 📝 更新维护

### 代码优化特性
- **精简架构** - 移除冗余代码，提升性能
- **统一消息处理** - 简化扩展内部通信机制
- **优化Cookie处理** - 精简Cookie提取和同步逻辑
- **改进UI响应** - 更快的界面渲染和状态更新

### 扩展更新
1. 替换扩展文件
2. 在扩展管理页面重新加载扩展
3. 配置会自动保留

## 🔐 权限说明

扩展请求的权限：
- **cookies** - 读取YouTube认证Cookie
- **activeTab** - 在当前标签页注入内容脚本
- **storage** - 存储配置和同步状态
- **background** - 后台持续运行Cookie同步服务

## 📞 技术支持

如遇问题，请提供：
1. 浏览器类型和版本
2. 扩展控制台错误日志
3. Y2A-Auto服务器日志
4. 详细的问题重现步骤

## 📄 许可证

遵循 Y2A-Auto 项目许可证。 